'''

Python web scraper

'''


import csv
from bs4 import BeautifulSoup

import requests


#import xlwt

#pythonWebScrapingGPUS = Workbook()

def create_csv_table(filename, data):
    """
    Creates a CSV file with the given filename, headers, and data.

    Args:
        filename (str): The name of the CSV file to create.
        headers (list): A list of strings representing the column headers.
        data (list of lists): A list of lists, where each inner list represents a row of data.
    """
    with open(filename, 'w', newline='') as csvfile:
        fieldnames = ['Name', 'Brand', 'Price', 'Availability', 'Reviews']
        writer = csv.DictWriter(csvfile, delimiter='|', fieldnames=fieldnames)
        
        writer.writeheader()
        writer.writerows(data)

url = 'https://www.newegg.com/p/pl?N=100007709%20601408874%20601432394%20601408875%20601432392%20601408873%20601432393%20601408877&PageSize=96'

page = requests.get(url)

soup = BeautifulSoup(page.text, 'html.parser')


itemObjects = soup.find_all('div', class_='item-cell')

#writing object headers to csv filename

filename = 'webscrapingGPUData'
headers = ['Name', 'Brand', 'Price', 'Availability', 'Reviews']

'''
writing to excel file
sheet1 =pythonWebScrapingGPUS.add_sheet('Sheet 1')

sheet1.write(0, 0, 'Name')
sheet1.write(0, 1, 'Brand')
sheet1.write(0, 2, 'Price')
sheet1.write(0, 3, 'Availability')
sheet1.write(0, 4, 'Reviews')
'''

itemDictionary = [ {'Name': 'NULL', 'Brand': 'NULL', 'Price': 'NULL', 'Availability': 'NULL', 'Reviews': 'NULL'} ]

for itemObject in itemObjects:
    
    try:
        Availability = itemObject.find('p', class_='item-promo').text
    except:
        Availability = 'IN STOCK'
        
    try:
        brandImage = itemObject.find('a', class_='item-brand').find('img')
        Brand = brandImage['alt']
    except:
        Brand = 'NULL'
    
    try:
        Name = ''
        Name += itemObject.find('a', class_='item-title').text
    except:
        Name = 'NULL'
        
    try:
        Price = itemObject.find('li', class_='price-current').find('strong').text
    except:
        Price = 'NULL'
        
    try:
        Reviews = itemObject.find('span', class_='item-rating-num').text
    except:
        Reviews = 'NULL'
    

    
    itemDictionary.append( {'Name': Name, 'Brand': Brand, 'Price': Price, 'Availability': Availability, 'Reviews': Reviews} )
    
    
    '''
    writing to excel file
    sheet1.write(rowNum, 0, Name)
    sheet1.write(rowNum, 1, Brand)
    sheet1.write(rowNum, 2, Price)
    sheet1.write(rowNum, 3, Availability)
    sheet1.write(rowNum, 4, Rating)
    '''
    print(Name)
    print(Brand)
    print(Price)
    print(Availability)
    print(Reviews)



create_csv_table(filename, itemDictionary)
    


    
    

